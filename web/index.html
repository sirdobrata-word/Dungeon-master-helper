<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <title>D&D Character Creator</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="styles.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&display=swap" rel="stylesheet">
  </head>
  <body>
    <div class="app">
      <header class="app-header">
        <h1>‚öîÔ∏è D&D Character Creator</h1>
        <p>–°–æ–∑–¥–∞–π –≥–µ—Ä–æ—è –∏ —É–ø—Ä–∞–≤–ª—è–π –ø–µ—Ä—Å–æ–Ω–∞–∂–∞–º–∏ D&D</p>

        <nav style="margin-top: 8px; font-size: 13px">
          <a href="/ui/index.html" style="color:#d4af37; text-decoration:none; margin-right:16px; text-shadow: 0 0 8px rgba(212,175,55,0.6);">üé≤ –°–æ–∑–¥–∞—Ç—å</a>
          <a href="/ui/list.html" style="color:#8b7355; text-decoration:none; margin-right:16px;">üìú –ü–µ—Ä—Å–æ–Ω–∞–∂–∏</a>
          <a href="/ui/monsters.html" style="color:#8b7355; text-decoration:none; margin-right:16px;">üëπ –ú–æ–Ω—Å—Ç—Ä—ã</a>
          <a href="/ui/companies.html" style="color:#8b7355; text-decoration:none;">‚öî –°–∫–ª–∞–¥</a>
        </nav>
      </header>

      <main class="app-main">
        <!-- –ë—ã—Å—Ç—Ä–∞—è –∫–Ω–æ–ø–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–º–ø–∞–Ω–∏–∏ -->
        <div style="grid-column: 1 / -1; margin-bottom: 16px; text-align: center;">
          <button onclick="showCreateCompanyModal()" class="btn primary" style="font-size: 14px; padding: 12px 24px;">
            ‚öî –°–æ–∑–¥–∞—Ç—å –∫–æ–º–ø–∞–Ω–∏—é
          </button>
        </div>
        <!-- –ë–ª–æ–∫ –±—Ä–æ—Å–∫–∞ –∫—É–±–∏–∫–æ–≤ -->
        <section class="card">
          <h2>–ë—Ä–æ—Å–æ–∫ –∫—É–±–∏–∫–æ–≤</h2>
          
          <!-- –ë—ã—Å—Ç—Ä—ã–µ –∫–Ω–æ–ø–∫–∏ –¥–ª—è –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –±—Ä–æ—Å–∫–æ–≤ -->
          <div style="margin-bottom: 12px;">
            <div style="font-size: 12px; color: #9ca3af; margin-bottom: 6px; text-transform: uppercase; letter-spacing: 0.1em;">
              –ë—ã—Å—Ç—Ä—ã–µ –±—Ä–æ—Å–∫–∏:
            </div>
            <div style="display: flex; flex-wrap: wrap; gap: 6px;">
              <button type="button" class="btn" style="padding: 6px 12px; font-size: 12px;" onclick="quickRoll('1d20')">1d20</button>
              <button type="button" class="btn" style="padding: 6px 12px; font-size: 12px;" onclick="quickRoll('2d6')">2d6</button>
              <button type="button" class="btn" style="padding: 6px 12px; font-size: 12px;" onclick="quickRoll('4d6')">4d6</button>
              <button type="button" class="btn" style="padding: 6px 12px; font-size: 12px;" onclick="quickRoll('1d100')">1d100</button>
              <button type="button" class="btn" style="padding: 6px 12px; font-size: 12px;" onclick="quickRoll('3d6')">3d6</button>
              <button type="button" class="btn" style="padding: 6px 12px; font-size: 12px;" onclick="quickRoll('1d12')">1d12</button>
              <button type="button" class="btn" style="padding: 6px 12px; font-size: 12px;" onclick="quickRoll('1d8')">1d8</button>
              <button type="button" class="btn" style="padding: 6px 12px; font-size: 12px;" onclick="quickRoll('1d4')">1d4</button>
            </div>
          </div>

          <form id="dice-form" class="form">
            <div class="form-row">
              <div class="field" style="flex: 1;">
                <label for="dice-expression">–í—ã—Ä–∞–∂–µ–Ω–∏–µ</label>
                <input 
                  id="dice-expression" 
                  type="text" 
                  placeholder="2d6 + 3" 
                  required
                  style="width: 100%;"
                />
                <small style="color: #9ca3af; font-size: 11px; margin-top: 4px; display: block;">
                  –ü—Ä–∏–º–µ—Ä—ã: 1d20, 2d6+3, 4d6, 1d20-2
                </small>
              </div>
            </div>
            <div class="form-actions">
              <button type="submit" class="btn primary">–ë—Ä–æ—Å–∏—Ç—å –∫—É–±–∏–∫–∏</button>
              <span id="dice-status" class="status"></span>
            </div>
          </form>

          <div id="dice-result" class="card" style="margin-top: 12px; padding: 12px; display: none; background: rgba(15, 23, 42, 0.95);">
            <h4 style="margin: 0 0 8px; font-size: 14px;">–†–µ–∑—É–ª—å—Ç–∞—Ç –±—Ä–æ—Å–∫–∞</h4>
            <div id="dice-result-content"></div>
          </div>
        </section>

        <!-- –§–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ -->
        <section class="card">
          <h2>–ù–æ–≤—ã–π –ø–µ—Ä—Å–æ–Ω–∞–∂</h2>
          <form id="character-form" class="form">
            <div class="form-row">
              <div class="field">
                <label for="name">–ò–º—è</label>
                <input id="name" name="name" type="text" required placeholder="–¢–∞—à–∞" />
              </div>
              <div class="field">
                <label for="class">–ö–ª–∞—Å—Å</label>
                <select id="class" name="class" required>
                  <option value="">–ù–µ –≤—ã–±—Ä–∞–Ω–æ</option>
                  <option value="–í–∞—Ä–≤–∞—Ä">–í–∞—Ä–≤–∞—Ä</option>
                  <option value="–ë–∞—Ä–¥">–ë–∞—Ä–¥</option>
                  <option value="–ñ—Ä–µ—Ü">–ñ—Ä–µ—Ü</option>
                  <option value="–î—Ä—É–∏–¥">–î—Ä—É–∏–¥</option>
                  <option value="–í–æ–∏–Ω" selected>–í–æ–∏–Ω</option>
                  <option value="–ú–æ–Ω–∞—Ö">–ú–æ–Ω–∞—Ö</option>
                  <option value="–ü–∞–ª–∞–¥–∏–Ω">–ü–∞–ª–∞–¥–∏–Ω</option>
                  <option value="–°–ª–µ–¥–æ–ø—ã—Ç">–°–ª–µ–¥–æ–ø—ã—Ç</option>
                  <option value="–ü–ª—É—Ç">–ü–ª—É—Ç</option>
                  <option value="–ß–∞—Ä–æ–¥–µ–π">–ß–∞—Ä–æ–¥–µ–π</option>
                  <option value="–ö–æ–ª–¥—É–Ω">–ö–æ–ª–¥—É–Ω</option>
                  <option value="–í–æ–ª—à–µ–±–Ω–∏–∫">–í–æ–ª—à–µ–±–Ω–∏–∫</option>
                  <option value="–ò–∑–æ–±—Ä–µ—Ç–∞—Ç–µ–ª—å">–ò–∑–æ–±—Ä–µ—Ç–∞—Ç–µ–ª—å</option>
                </select>
              </div>
            </div>

            <div class="form-row">
              <div class="field">
                <label for="race">–†–∞—Å–∞</label>
                <select id="race" name="race" required>
                  <option value="">–ù–µ –≤—ã–±—Ä–∞–Ω–æ</option>
                  <option value="–ß–µ–ª–æ–≤–µ–∫" selected>–ß–µ–ª–æ–≤–µ–∫</option>
                  <option value="–≠–ª—å—Ñ">–≠–ª—å—Ñ</option>
                  <option value="–î–≤–∞—Ä—Ñ">–î–≤–∞—Ä—Ñ</option>
                  <option value="–ü–æ–ª—É—Ä–æ—Å–ª–∏–∫">–ü–æ–ª—É—Ä–æ—Å–ª–∏–∫</option>
                  <option value="–î—Ä–∞–∫–æ–Ω–æ—Ä–æ–∂–¥—ë–Ω–Ω—ã–π">–î—Ä–∞–∫–æ–Ω–æ—Ä–æ–∂–¥—ë–Ω–Ω—ã–π</option>
                  <option value="–ì–Ω–æ–º">–ì–Ω–æ–º</option>
                  <option value="–ü–æ–ª—É—ç–ª—å—Ñ">–ü–æ–ª—É—ç–ª—å—Ñ</option>
                  <option value="–ü–æ–ª—É–æ—Ä–∫">–ü–æ–ª—É–æ—Ä–∫</option>
                  <option value="–¢–∏—Ñ–ª–∏–Ω–≥">–¢–∏—Ñ–ª–∏–Ω–≥</option>
                  <option value="–ê–∞–∑–∏–º–∞—Ä">–ê–∞–∑–∏–º–∞—Ä</option>
                  <option value="–ì–æ–ª–∏–∞—Ñ">–ì–æ–ª–∏–∞—Ñ</option>
                  <option value="–¢–∞—Ä–∞–∫–∏—Ç">–¢–∞—Ä–∞–∫–∏—Ç</option>
                  <option value="–ö–µ–Ω–∫—É">–ö–µ–Ω–∫—É</option>
                  <option value="–¢–∞–±–∞–∫—Å–∏">–¢–∞–±–∞–∫—Å–∏</option>
                  <option value="–§–∏—Ä–±–æ–ª–≥">–§–∏—Ä–±–æ–ª–≥</option>
                </select>
              </div>
              <div class="field">
                <label for="background">–ü—Ä–µ–¥—ã—Å—Ç–æ—Ä–∏—è</label>
                <select id="background" name="background" required>
                  <option value="">–ù–µ –≤—ã–±—Ä–∞–Ω–æ</option>
                  <option value="–ü—Ä–∏—Å–ª—É–∂–Ω–∏–∫">–ü—Ä–∏—Å–ª—É–∂–Ω–∏–∫</option>
                  <option value="–ê—Ä—Ç–∏—Å—Ç">–ê—Ä—Ç–∏—Å—Ç</option>
                  <option value="–®–∞—Ä–ª–∞—Ç–∞–Ω">–®–∞—Ä–ª–∞—Ç–∞–Ω</option>
                  <option value="–ü—Ä–µ—Å—Ç—É–ø–Ω–∏–∫">–ü—Ä–µ—Å—Ç—É–ø–Ω–∏–∫</option>
                  <option value="–ù–∞—Ä–æ–¥–Ω—ã–π –≥–µ—Ä–æ–π">–ù–∞—Ä–æ–¥–Ω—ã–π –≥–µ—Ä–æ–π</option>
                  <option value="–ì–∏–ª—å–¥–µ–π—Å–∫–∏–π —Ä–µ–º–µ—Å–ª–µ–Ω–Ω–∏–∫">–ì–∏–ª—å–¥–µ–π—Å–∫–∏–π —Ä–µ–º–µ—Å–ª–µ–Ω–Ω–∏–∫</option>
                  <option value="–û—Ç—à–µ–ª—å–Ω–∏–∫">–û—Ç—à–µ–ª—å–Ω–∏–∫</option>
                  <option value="–ë–ª–∞–≥–æ—Ä–æ–¥–Ω—ã–π">–ë–ª–∞–≥–æ—Ä–æ–¥–Ω—ã–π</option>
                  <option value="–ß—É–∂–µ–∑–µ–º–µ—Ü">–ß—É–∂–µ–∑–µ–º–µ—Ü</option>
                  <option value="–ú—É–¥—Ä–µ—Ü" selected>–ú—É–¥—Ä–µ—Ü</option>
                  <option value="–ú–æ—Ä—è–∫">–ú–æ—Ä—è–∫</option>
                  <option value="–°–æ–ª–¥–∞—Ç">–°–æ–ª–¥–∞—Ç</option>
                  <option value="–ë–µ—Å–ø—Ä–∏–∑–æ—Ä–Ω–∏–∫">–ë–µ—Å–ø—Ä–∏–∑–æ—Ä–Ω–∏–∫</option>
                </select>
              </div>
            </div>

            <div class="form-row">
              <div class="field">
                <label for="level">–£—Ä–æ–≤–µ–Ω—å</label>
                <select id="level" name="level">
                  <option value="1">1</option>
                  <option value="2">2</option>
                  <option value="3">3</option>
                  <option value="4">4</option>
                  <option value="5" selected>5</option>
                  <option value="6">6</option>
                  <option value="7">7</option>
                  <option value="8">8</option>
                  <option value="9">9</option>
                  <option value="10">10</option>
                </select>
              </div>
              <div class="field">
                <label for="alignment">–ú–∏—Ä–æ–≤–æ–∑–∑—Ä–µ–Ω–∏–µ</label>
                <select id="alignment" name="alignment">
                  <option value="">–ù–µ –≤—ã–±—Ä–∞–Ω–æ</option>
                  <option value="–ó–∞–∫–æ–Ω–Ω–æ-–¥–æ–±—Ä—ã–π">–ó–∞–∫–æ–Ω–Ω–æ-–¥–æ–±—Ä—ã–π</option>
                  <option value="–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ-–¥–æ–±—Ä—ã–π">–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ-–¥–æ–±—Ä—ã–π</option>
                  <option value="–•–∞–æ—Ç–∏—á–Ω–æ-–¥–æ–±—Ä—ã–π">–•–∞–æ—Ç–∏—á–Ω–æ-–¥–æ–±—Ä—ã–π</option>
                  <option value="–ó–∞–∫–æ–Ω–Ω–æ-–Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π">–ó–∞–∫–æ–Ω–Ω–æ-–Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π</option>
                  <option value="–ò—Å—Ç–∏–Ω–Ω–æ-–Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π" selected>–ò—Å—Ç–∏–Ω–Ω–æ-–Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π</option>
                  <option value="–•–∞–æ—Ç–∏—á–Ω–æ-–Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π">–•–∞–æ—Ç–∏—á–Ω–æ-–Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π</option>
                  <option value="–ó–∞–∫–æ–Ω–Ω–æ-–∑–ª–æ–π">–ó–∞–∫–æ–Ω–Ω–æ-–∑–ª–æ–π</option>
                  <option value="–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ-–∑–ª–æ–π">–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ-–∑–ª–æ–π</option>
                  <option value="–•–∞–æ—Ç–∏—á–Ω–æ-–∑–ª–æ–π">–•–∞–æ—Ç–∏—á–Ω–æ-–∑–ª–æ–π</option>
                </select>
              </div>
            </div>

            <div class="form-row">
              <div class="field" style="flex: 1;">
                <label for="skills">–ù–∞–≤—ã–∫–∏ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)</label>
                <input
                  id="skills"
                  name="skills"
                  type="text"
                  placeholder="–í–æ—Å–ø—Ä–∏—è—Ç–∏–µ, –°–∫—Ä—ã—Ç–Ω–æ—Å—Ç—å, –ê–∫—Ä–æ–±–∞—Ç–∏–∫–∞"
                />
                <small style="color: #9ca3af; font-size: 11px; margin-top: 4px; display: block;">
                  –ü—Ä–∏–º–µ—Ä—ã: –ê–∫—Ä–æ–±–∞—Ç–∏–∫–∞, –ê–Ω–∞–ª–∏–∑, –ê—Ç–ª–µ—Ç–∏–∫–∞, –í–æ—Å–ø—Ä–∏—è—Ç–∏–µ, –í—ã–∂–∏–≤–∞–Ω–∏–µ, –í—ã—Å—Ç—É–ø–ª–µ–Ω–∏–µ, –ó–∞–ø—É–≥–∏–≤–∞–Ω–∏–µ, –ò—Å—Ç–æ—Ä–∏—è, –õ–æ–≤–∫–æ—Å—Ç—å —Ä—É–∫, –ú–∞–≥–∏—è, –ú–µ–¥–∏—Ü–∏–Ω–∞, –û–±–º–∞–Ω, –ü—Ä–∏—Ä–æ–¥–∞, –ü—Ä–æ–Ω–∏—Ü–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –†–µ–ª–∏–≥–∏—è, –°–∫—Ä—ã—Ç–Ω–æ—Å—Ç—å, –£–±–µ–∂–¥–µ–Ω–∏–µ, –£—Ö–æ–¥ –∑–∞ –∂–∏–≤–æ—Ç–Ω—ã–º–∏
                </small>
              </div>
            </div>

            <div class="form-actions" style="flex-wrap: wrap; gap: 8px;">
              <button type="button" class="btn primary" id="manual-toggle" style="background: linear-gradient(135deg, #8b5cf6, #6366f1);">
                ‚úèÔ∏è –†—É—á–Ω–æ–π —Ä–µ–∂–∏–º
              </button>
              <button type="submit" class="btn primary" id="submit-btn">
                ‚ú® –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ (–∞–≤—Ç–æ)
              </button>
              <span id="status" class="status"></span>
            </div>

            <!-- –ë–ª–æ–∫ —Ä—É—á–Ω–æ–≥–æ –≤–≤–æ–¥–∞ (—Å–∫—Ä—ã—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
            <div
              id="manual-section"
              class="card"
              style="margin-top:10px; padding:14px 16px; display:none;"
            >
              <h3
                style="margin:0 0 8px; font-size:14px; text-transform:uppercase; letter-spacing:.1em; color:#9ca3af;"
              >
                –†—É—á–Ω–æ–π –≤–≤–æ–¥ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –∏ –±–æ–µ–≤—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
              </h3>

              <div class="form-row">
                <div class="field">
                  <label for="str-input">STR</label>
                  <input id="str-input" type="number" min="1" max="30" placeholder="15" />
                </div>
                <div class="field">
                  <label for="dex-input">DEX</label>
                  <input id="dex-input" type="number" min="1" max="30" placeholder="14" />
                </div>
                <div class="field">
                  <label for="con-input">CON</label>
                  <input id="con-input" type="number" min="1" max="30" placeholder="14" />
                </div>
              </div>

              <div class="form-row">
                <div class="field">
                  <label for="int-input">INT</label>
                  <input id="int-input" type="number" min="1" max="30" placeholder="12" />
                </div>
                <div class="field">
                  <label for="wis-input">WIS</label>
                  <input id="wis-input" type="number" min="1" max="30" placeholder="13" />
                </div>
                <div class="field">
                  <label for="cha-input">CHA</label>
                  <input id="cha-input" type="number" min="1" max="30" placeholder="10" />
                </div>
              </div>

              <div class="form-row">
                <div class="field">
                  <label for="prof-input">–ü—Ä–æ—Ñ. –±–æ–Ω—É—Å</label>
                  <input id="prof-input" type="number" placeholder="3" />
                </div>
                <div class="field">
                  <label for="ac-input">–ö–î (AC)</label>
                  <input id="ac-input" type="number" placeholder="16" />
                </div>
                <div class="field">
                  <label for="speed-input">–°–∫–æ—Ä–æ—Å—Ç—å</label>
                  <input id="speed-input" type="number" placeholder="30" />
                </div>
              </div>

              <div class="form-row">
                <div class="field">
                  <label for="initiative-input">–ò–Ω–∏—Ü–∏–∞—Ç–∏–≤–∞</label>
                  <input id="initiative-input" type="number" placeholder="2" />
                </div>
                <div class="field">
                  <label for="maxhp-input">–ú–∞–∫—Å. —Ö–∏—Ç—ã</label>
                  <input id="maxhp-input" type="number" placeholder="45" />
                </div>
                <div class="field">
                  <label for="curhp-input">–¢–µ–∫—É—â–∏–µ —Ö–∏—Ç—ã</label>
                  <input id="curhp-input" type="number" placeholder="45" />
                </div>
              </div>

              <div class="form-row">
                <div class="field">
                  <label for="temphp-input">–í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ö–∏—Ç—ã</label>
                  <input id="temphp-input" type="number" placeholder="0" />
                </div>
              </div>
            </div>
          </form>
        </section>

        <section class="card">
          <h2>–†–µ–∑—É–ª—å—Ç–∞—Ç</h2>
          <div id="result-empty" class="result-empty">
            –ó–∞–ø–æ–ª–Ω–∏ —Ñ–æ—Ä–º—É –∏ –Ω–∞–∂–º–∏ ¬´–°–æ–∑–¥–∞—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞¬ª, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –ª–∏—Å—Ç.
          </div>

          <div id="result" class="result hidden">
            <div class="result-header">
              <div>
                <h3 id="res-name"></h3>
                <p id="res-meta" class="result-meta"></p>
              </div>
              <div class="result-id">
                <span class="label">ID</span>
                <code id="res-id"></code>
              </div>
            </div>

            <!-- –ú–∏—Ä–æ–≤–æ–∑–∑—Ä–µ–Ω–∏–µ -->
            <div id="res-alignment-block" class="grid-card" style="margin-bottom: 12px; display: none;">
              <h4>–ú–∏—Ä–æ–≤–æ–∑–∑—Ä–µ–Ω–∏–µ</h4>
              <div id="res-alignment" style="font-size: 16px; color: #d4af37; font-weight: 600;"></div>
            </div>

            <div class="grid">
              <div class="grid-card">
                <h4>–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</h4>
                <ul class="abilities">
                  <li><span>STR</span><strong id="str-val"></strong></li>
                  <li><span>DEX</span><strong id="dex-val"></strong></li>
                  <li><span>CON</span><strong id="con-val"></strong></li>
                  <li><span>INT</span><strong id="int-val"></strong></li>
                  <li><span>WIS</span><strong id="wis-val"></strong></li>
                  <li><span>CHA</span><strong id="cha-val"></strong></li>
                </ul>
              </div>

              <div class="grid-card">
                <h4>–ë–æ–π</h4>
                <dl class="stats">
                  <div>
                    <dt>–ö–î (AC)</dt>
                    <dd id="ac-val"></dd>
                  </div>
                  <div>
                    <dt>–•–∏—Ç—ã</dt>
                    <dd>
                      <span id="hp-current-val"></span>/<span id="hp-max-val"></span>
                    </dd>
                  </div>
                  <div>
                    <dt>–ò–Ω–∏—Ü–∏–∞—Ç–∏–≤–∞</dt>
                    <dd id="initiative-val"></dd>
                  </div>
                  <div>
                    <dt>–°–∫–æ—Ä–æ—Å—Ç—å</dt>
                    <dd><span id="speed-val"></span> ft</dd>
                  </div>
                  <div>
                    <dt>–ü—Ä–æ—Ñ. –±–æ–Ω—É—Å</dt>
                    <dd id="prof-val"></dd>
                  </div>
                </dl>
              </div>
            </div>

            <!-- –ù–∞–≤—ã–∫–∏ -->
            <div id="res-skills-block" class="grid-card" style="margin-top: 12px; display: none;">
              <h4>–ù–∞–≤—ã–∫–∏</h4>
              <div id="res-skills" style="display: flex; flex-wrap: wrap; gap: 6px;"></div>
            </div>
          </div>
        </section>
      </main>

      <footer class="app-footer">
        <span>D&D Character Sheet Service ¬∑ Go backend + HTML UI</span>
      </footer>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–º–ø–∞–Ω–∏–∏ -->
    <div id="companyModal" class="modal-overlay hidden" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.85); align-items: center; justify-content: center; z-index: 1000;">
      <div class="modal" style="background: linear-gradient(135deg, rgba(20, 10, 5, 0.98) 0%, rgba(10, 5, 2, 0.99) 100%); border: 2px solid rgba(139, 0, 0, 0.6); border-radius: 12px; padding: 28px; width: 90%; max-width: 500px; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.9), 0 0 40px rgba(139, 0, 0, 0.3);">
        <h3 style="margin: 0 0 20px; color: #d4af37; font-size: 22px; text-shadow: 0 0 10px rgba(212, 175, 55, 0.5); border-bottom: 2px solid rgba(139, 0, 0, 0.5); padding-bottom: 12px;">–°–æ–∑–¥–∞—Ç—å –∫–æ–º–ø–∞–Ω–∏—é</h3>
        <form id="companyForm" class="form">
          <div class="field">
            <label for="companyName">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏</label>
            <input type="text" id="companyName" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ì–∏–ª—å–¥–∏—è –ò—Å–∫–∞—Ç–µ–ª–µ–π" required>
          </div>
          <div class="field">
            <label for="companyDescription">–û–ø–∏—Å–∞–Ω–∏–µ</label>
            <textarea id="companyDescription" rows="3" placeholder="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã..."></textarea>
          </div>
          <div style="display: flex; gap: 12px; margin-top: 20px; justify-content: flex-end;">
            <button type="button" class="btn" onclick="hideCompanyModal()">–û—Ç–º–µ–Ω–∞</button>
            <button type="submit" class="btn primary">üíæ –°–æ–∑–¥–∞—Ç—å</button>
          </div>
          <span id="companyFormStatus" class="status" style="display: block; margin-top: 12px;"></span>
        </form>
      </div>
    </div>

    <script>
      // –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞: –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ –∑–∞–≥—Ä—É–∑–∫–∏
      (function() {
        const protocol = window.location.protocol;
        const hostname = window.location.hostname;
        const pathname = window.location.pathname;
        
        console.log("=== –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–µ—Ä–≤–∏—Å–∞ ===");
        console.log("–ü—Ä–æ—Ç–æ–∫–æ–ª:", protocol);
        console.log("–•–æ—Å—Ç:", hostname);
        console.log("–ü—É—Ç—å:", pathname);
        console.log("–ü–æ–ª–Ω—ã–π URL:", window.location.href);
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –æ—Ç–∫—Ä—ã—Ç–∞ —á–µ—Ä–µ–∑ http, –∞ –Ω–µ file://
        if (protocol === "file:") {
          const errorMsg = "‚ö†Ô∏è –û–®–ò–ë–ö–ê: –°—Ç—Ä–∞–Ω–∏—Ü–∞ –æ—Ç–∫—Ä—ã—Ç–∞ –∫–∞–∫ –ª–æ–∫–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª!\n\n" +
            "–ü—Ä–∞–≤–∏–ª—å–Ω–æ: http://localhost:9190/ui/index.html\n" +
            "–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ: file:///C:/...\n\n" +
            "–ó–∞–ø—É—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä –∏ –æ—Ç–∫—Ä–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—É —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä —Å –∞–¥—Ä–µ—Å–æ–º http://localhost:9190/ui/index.html";
          alert(errorMsg);
          console.error(errorMsg);
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∞
        fetch("/healthz")
          .then(res => {
            if (res.ok) {
              console.log("‚úÖ –°–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω");
            } else {
              console.warn("‚ö†Ô∏è –°–µ—Ä–≤–µ—Ä –æ—Ç–≤–µ—á–∞–µ—Ç, –Ω–æ —Å—Ç–∞—Ç—É—Å:", res.status);
            }
          })
          .catch(err => {
            console.error("‚ùå –°–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω:", err);
            console.error("–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω: go run cmd/server/main.go");
          });
      })();
      
      // –ë—Ä–æ—Å–æ–∫ –∫—É–±–∏–∫–æ–≤
      const diceForm = document.getElementById("dice-form");
      const diceStatus = document.getElementById("dice-status");
      const diceResult = document.getElementById("dice-result");
      const diceResultContent = document.getElementById("dice-result-content");
      const diceExpressionInput = document.getElementById("dice-expression");

      // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –±—Ä–æ—Å–∫–∞
      async function quickRoll(expression) {
        diceExpressionInput.value = expression;
        diceStatus.textContent = "–ë—Ä–æ—Å–∞—é –∫—É–±–∏–∫–∏...";
        diceStatus.classList.remove("error");
        diceResult.style.display = "none";

        try {
          const res = await fetch("/roll", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({ expression }),
          });

          const data = await res.json().catch(() => null);

          if (!res.ok) {
            const msg = (data && data.error) || "–û—à–∏–±–∫–∞ –±—Ä–æ—Å–∫–∞ –∫—É–±–∏–∫–æ–≤";
            diceStatus.textContent = msg;
            diceStatus.classList.add("error");
            return;
          }

          diceStatus.textContent = "–£—Å–ø–µ—à–Ω–æ";
          diceStatus.classList.remove("error");

          // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
          diceResult.style.display = "block";
          diceResultContent.innerHTML = `
            <div style="margin-bottom: 6px;">
              <strong>–í—ã—Ä–∞–∂–µ–Ω–∏–µ:</strong> ${data.expression}
            </div>
            <div style="margin-bottom: 6px;">
              <strong>–ë—Ä–æ—Å–∫–∏:</strong> [${data.rolls.join(", ")}]
            </div>
            ${data.modifier !== 0 ? `<div style="margin-bottom: 6px;"><strong>–ú–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä:</strong> ${data.modifier > 0 ? "+" : ""}${data.modifier}</div>` : ""}
            <div style="font-size: 18px; font-weight: 600; color: #a5b4fc;">
              <strong>–ò—Ç–æ–≥–æ:</strong> ${data.total}
            </div>
          `;
        } catch (err) {
          console.error(err);
          diceStatus.textContent = "–°–µ—Ç–µ–≤–æ–π —Å–±–æ–π";
          diceStatus.classList.add("error");
        }
      }

      diceForm.addEventListener("submit", async (e) => {
        e.preventDefault();
        diceStatus.textContent = "–ë—Ä–æ—Å–∞—é –∫—É–±–∏–∫–∏...";
        diceStatus.classList.remove("error");
        diceResult.style.display = "none";

        const expression = document.getElementById("dice-expression").value.trim();

        try {
          const res = await fetch("/roll", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({ expression }),
          });

          const data = await res.json().catch(() => null);

          if (!res.ok) {
            const msg = (data && data.error) || "–û—à–∏–±–∫–∞ –±—Ä–æ—Å–∫–∞ –∫—É–±–∏–∫–æ–≤";
            diceStatus.textContent = msg;
            diceStatus.classList.add("error");
            return;
          }

          diceStatus.textContent = "–£—Å–ø–µ—à–Ω–æ";
          diceStatus.classList.remove("error");

          // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
          diceResult.style.display = "block";
          diceResultContent.innerHTML = `
            <div style="margin-bottom: 6px;">
              <strong>–í—ã—Ä–∞–∂–µ–Ω–∏–µ:</strong> ${data.expression}
            </div>
            <div style="margin-bottom: 6px;">
              <strong>–ë—Ä–æ—Å–∫–∏:</strong> [${data.rolls.join(", ")}]
            </div>
            ${data.modifier !== 0 ? `<div style="margin-bottom: 6px;"><strong>–ú–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä:</strong> ${data.modifier > 0 ? "+" : ""}${data.modifier}</div>` : ""}
            <div style="font-size: 18px; font-weight: 600; color: #a5b4fc;">
              <strong>–ò—Ç–æ–≥–æ:</strong> ${data.total}
            </div>
          `;
        } catch (err) {
          console.error(err);
          diceStatus.textContent = "–°–µ—Ç–µ–≤–æ–π —Å–±–æ–π";
          diceStatus.classList.add("error");
        }
      });

      // –°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
      const form = document.getElementById("character-form");
      const statusEl = document.getElementById("status");
      const resultEmpty = document.getElementById("result-empty");
      const result = document.getElementById("result");
      const manualSection = document.getElementById("manual-section");
      const submitBtn = document.getElementById("submit-btn");
      const manualToggle = document.getElementById("manual-toggle");

      let isManual = false;

      manualToggle.addEventListener("click", () => {
        isManual = !isManual;
        manualSection.style.display = isManual ? "block" : "none";
        if (isManual) {
          manualToggle.textContent = "‚ùå –í—ã–∫–ª—é—á–∏—Ç—å —Ä—É—á–Ω–æ–π —Ä–µ–∂–∏–º";
          manualToggle.style.background = "linear-gradient(135deg, #ef4444, #dc2626)";
          submitBtn.textContent = "üíæ –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ (—Ä—É—á–Ω–æ–π)";
        } else {
          manualToggle.textContent = "‚úèÔ∏è –†—É—á–Ω–æ–π —Ä–µ–∂–∏–º";
          manualToggle.style.background = "linear-gradient(135deg, #8b5cf6, #6366f1)";
          submitBtn.textContent = "‚ú® –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ (–∞–≤—Ç–æ)";
        }
      });

      form.addEventListener("submit", async (e) => {
        e.preventDefault();
        statusEl.textContent = "–û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞...";
        statusEl.classList.remove("error");
        submitBtn.disabled = true;

        // –ü–∞—Ä—Å–∏–º –Ω–∞–≤—ã–∫–∏ –∏–∑ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—è
        const skillsRaw = form.skills.value.trim();
        const skills = skillsRaw ? skillsRaw.split(',').map(s => s.trim()).filter(s => s) : [];

        const commonPayload = {
          name: form.name.value.trim(),
          class: form.class.value.trim(),
          race: form.race.value.trim(),
          background: form.background.value.trim(),
          level: Number(form.level.value),
          alignment: form.alignment.value,
          skills: skills,
        };

        let url = "/characters/generate";
        let payload = commonPayload;

        if (isManual) {
          url = "/characters";
          payload = {
            ...commonPayload,
            abilityScores: {
              strength: numberOrZero("str-input"),
              dexterity: numberOrZero("dex-input"),
              constitution: numberOrZero("con-input"),
              intelligence: numberOrZero("int-input"),
              wisdom: numberOrZero("wis-input"),
              charisma: numberOrZero("cha-input"),
            },
            proficiencyBonus: numberOrZero("prof-input"),
            armorClass: numberOrZero("ac-input"),
            speed: numberOrZero("speed-input"),
            initiative: numberOrZero("initiative-input"),
            maxHitPoints: numberOrZero("maxhp-input"),
            currentHitPoints: numberOrZero("curhp-input"),
            temporaryHitPoints: numberOrZero("temphp-input"),
          };
        }

        try {
          const res = await fetch(url, {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(payload),
          });

          const data = await res.json().catch(() => null);

          if (!res.ok) {
            const msg = data && data.error ? data.error : "–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞";
            statusEl.textContent = msg;
            statusEl.classList.add("error");
            return;
          }

          statusEl.textContent = "–ü–µ—Ä—Å–æ–Ω–∞–∂ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω";
          statusEl.classList.remove("error");
          showResult(data);
        } catch (err) {
          console.error(err);
          statusEl.textContent = "–°–µ—Ç–µ–≤–æ–π —Å–±–æ–π. –ü—Ä–æ–≤–µ—Ä—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∏–ª–∏ –ª–æ–≥ —Å–µ—Ä–≤–µ—Ä–∞.";
          statusEl.classList.add("error");
        } finally {
          submitBtn.disabled = false;
        }
      });

      function numberOrZero(id) {
        const el = document.getElementById(id);
        const v = el.value.trim();
        if (v === "") return 0;
        const num = Number(v);
        return Number.isNaN(num) ? 0 : num;
      }

      function showResult(data) {
        resultEmpty.classList.add("hidden");
        result.classList.remove("hidden");

        document.getElementById("res-name").textContent = data.name;
        document.getElementById(
          "res-meta"
        ).textContent = `${data.race} ¬∑ ${data.class} ¬∑ —É—Ä–æ–≤–µ–Ω—å ${data.level}`;
        document.getElementById("res-id").textContent = data.id;

        // –ú–∏—Ä–æ–≤–æ–∑–∑—Ä–µ–Ω–∏–µ
        const alignmentBlock = document.getElementById("res-alignment-block");
        const alignmentEl = document.getElementById("res-alignment");
        if (data.alignment) {
          alignmentBlock.style.display = "block";
          alignmentEl.textContent = data.alignment;
        } else {
          alignmentBlock.style.display = "none";
        }

        const ab = data.abilityScores || {};
        document.getElementById("str-val").textContent = ab.strength ?? "-";
        document.getElementById("dex-val").textContent = ab.dexterity ?? "-";
        document.getElementById("con-val").textContent = ab.constitution ?? "-";
        document.getElementById("int-val").textContent = ab.intelligence ?? "-";
        document.getElementById("wis-val").textContent = ab.wisdom ?? "-";
        document.getElementById("cha-val").textContent = ab.charisma ?? "-";

        document.getElementById("ac-val").textContent = data.armorClass ?? "-";
        document.getElementById("hp-current-val").textContent =
          data.currentHitPoints ?? "-";
        document.getElementById("hp-max-val").textContent =
          data.maxHitPoints ?? "-";
        document.getElementById("initiative-val").textContent =
          data.initiative ?? "-";
        document.getElementById("speed-val").textContent = data.speed ?? "-";
        document.getElementById("prof-val").textContent =
          data.proficiencyBonus ?? "-";

        // –ù–∞–≤—ã–∫–∏
        const skillsBlock = document.getElementById("res-skills-block");
        const skillsEl = document.getElementById("res-skills");
        const skills = data.skills || [];
        if (skills.length > 0) {
          skillsBlock.style.display = "block";
          skillsEl.innerHTML = skills.map(skill => 
            `<span style="background: rgba(139, 0, 0, 0.3); border: 1px solid rgba(139, 0, 0, 0.5); border-radius: 4px; padding: 4px 10px; font-size: 13px; color: #d4af37;">${skill}</span>`
          ).join('');
        } else {
          skillsBlock.style.display = "none";
        }
      }

      // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–æ–º–ø–∞–Ω–∏–µ–π
      async function showCreateCompanyModal() {
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–µ—Ä–∞ –ø–µ—Ä–µ–¥ –æ—Ç–∫—Ä—ã—Ç–∏–µ–º –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        try {
          const healthCheck = await fetch("/healthz").catch(() => null);
          if (!healthCheck || !healthCheck.ok) {
            alert("‚ö†Ô∏è –°–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω!\n\n–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ http://localhost:9190\n\n–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä –∫–æ–º–∞–Ω–¥–æ–π:\ngo run cmd/server/main.go");
            return;
          }
        } catch (err) {
          alert("‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É!\n\n–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ http://localhost:9190");
          return;
        }
        
        const modal = document.getElementById("companyModal");
        modal.classList.remove("hidden");
        modal.style.display = "flex";
        document.getElementById("companyName").value = "";
        document.getElementById("companyDescription").value = "";
        document.getElementById("companyFormStatus").textContent = "";
        document.getElementById("companyFormStatus").classList.remove("error");
      }

      function hideCompanyModal() {
        const modal = document.getElementById("companyModal");
        modal.classList.add("hidden");
        modal.style.display = "none";
      }

      // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ñ–æ—Ä–º—ã —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–º–ø–∞–Ω–∏–∏
      document.getElementById("companyForm").addEventListener("submit", async (e) => {
        e.preventDefault();
        
        const submitBtn = e.target.querySelector('button[type="submit"]');
        const statusEl = document.getElementById("companyFormStatus");
        const originalText = submitBtn.textContent;
        
        submitBtn.textContent = "–°–æ–∑–¥–∞–Ω–∏–µ...";
        submitBtn.disabled = true;
        statusEl.textContent = "";
        statusEl.classList.remove("error");
        
        const name = document.getElementById("companyName").value.trim();
        const description = document.getElementById("companyDescription").value.trim();
        
        if (!name) {
          statusEl.textContent = "–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏!";
          statusEl.classList.add("error");
          submitBtn.textContent = originalText;
          submitBtn.disabled = false;
          return;
        }
        
        try {
          const payload = { name, description };
          console.log("–û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏:", payload);
          
          const res = await fetch("/companies", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(payload)
          }).catch(fetchError => {
            console.error("–û—à–∏–±–∫–∞ —Å–µ—Ç–∏ –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ:", fetchError);
            throw new Error("–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ http://localhost:9190");
          });
          
          console.log("–°—Ç–∞—Ç—É—Å –æ—Ç–≤–µ—Ç–∞:", res.status, res.statusText);
          
          // –ö–ª–æ–Ω–∏—Ä—É–µ–º –æ—Ç–≤–µ—Ç –¥–ª—è —á—Ç–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –ø—Ä–∏ –æ—à–∏–±–∫–µ
          const resClone = res.clone();
          let result;
          
          try {
            result = await res.json();
          } catch (parseErr) {
            // –ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å JSON, —á–∏—Ç–∞–µ–º –∫–∞–∫ —Ç–µ–∫—Å—Ç
            const text = await resClone.text();
            console.error("–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON:", text);
            throw new Error(`–°–µ—Ä–≤–µ—Ä –≤–µ—Ä–Ω—É–ª –æ—à–∏–±–∫—É: ${res.status} ${res.statusText}. ${text}`);
          }
          
          console.log("–û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞:", result);
          
          if (!res.ok) {
            const errorMsg = result.error || result.message || `–û—à–∏–±–∫–∞ ${res.status}: ${res.statusText}`;
            throw new Error(errorMsg);
          }
          
          statusEl.textContent = "‚úÖ –ö–æ–º–ø–∞–Ω–∏—è —Å–æ–∑–¥–∞–Ω–∞! –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å–∫–ª–∞–¥–∞...";
          statusEl.classList.remove("error");
          
          setTimeout(() => {
            // –î–æ–±–∞–≤–ª—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä refresh –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞
            window.location.href = "/ui/companies.html?refresh=true";
          }, 1500);
        } catch (err) {
          console.error("–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–º–ø–∞–Ω–∏–∏:", err);
          let errorMessage = err.message;
          
          // –ë–æ–ª–µ–µ –ø–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
          if (errorMessage.includes("Failed to fetch") || errorMessage.includes("NetworkError")) {
            errorMessage = "–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ http://localhost:9190";
          } else if (errorMessage.includes("404")) {
            errorMessage = "–°–µ—Ä–≤–µ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ http://localhost:9190";
          }
          
          statusEl.textContent = "–û—à–∏–±–∫–∞: " + errorMessage;
          statusEl.classList.add("error");
          submitBtn.textContent = originalText;
          submitBtn.disabled = false;
        }
      });
    </script>
  </body>
</html>
